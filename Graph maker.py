# -*- coding: utf-8 -*-
"""
Created on Sun Mar  6 12:31:38 2022

@author: user
"""

import matplotlib.pyplot as plt
import matplotlib.gridspec as gridspec
from scipy.signal import savgol_filter
import pandas as pd
import numpy as np
from scipy.interpolate import splrep
from matplotlib.widgets import Slider

#SAVGOL 2 Polynomial
savgol2x = [51, 49, 47, 45, 43, 41, 39, 37, 35, 33, 31, 29, 27, 25, 23, 21, 19, 17, 15, 13, 11, 9, 7, 5]
savgol2y = [473067079.3, 394871903.9, 313516522.3, 237181364.6, 172450406.1, 123801765.6, 90825488.16,	69209975.41, 53886727.01, 41468238.45, 30484606.22,	21051247.42, 13649744.99, 8376684.307, 4868526.225, 2713839.716, 1481035.739, 868298.1676, 559823.2916, 420110.3568, 342558.2627, 276875.5009, 209663.9955, 155723.4988]
#plt.plot(savgol2x, savgol2y,'.')
#plt.plot(savgol2x, savgol2y,'-',label='2nd order')



#SAVGOL 3 Polynomial
savgol3x = [51, 49, 47, 45, 43, 41, 39, 37, 35, 33, 31, 29, 27, 25, 23, 21, 19, 17, 15, 13, 11, 9, 7, 5]
savgol3y = [263800516, 242842249.8, 219175826.4, 191178508.6, 159202436.4, 126393359, 96397621.6, 71476812.04, 51989806.69, 37187950.01, 26101420.95, 17793096.59, 11666714.03, 7325243.674, 4395522.473, 2533509.522, 1424809.013,855116.4928, 558734.1044, 420548.6716, 342300.4617, 276508.5129, 209661.0748, 155792.5431]
#plt.plot(savgol3x, savgol3y,'.')
#plt.plot(savgol3x, savgol3y,'-',label='3rd order')
plt.xlabel('Window Size')
plt.ylabel('Sum of the Square of the Difference (c^2ps)')
plt.title('Discrepency Values vs window Size for the Savgol filter at a 4th order polynomial', wrap=True)
plt.yscale("log")

#SAVGOL 4 Polynomial
savgol4x = [51, 49, 47, 45, 43, 41, 39, 37, 35, 33, 31, 29, 27, 25, 23, 21, 19, 17, 15, 13, 11, 9, 7]
savgol4y = [59397453.12, 38045937.84, 24232502.14, 16618072.15, 12754666.36, 10156211.63, 7680386.227, 5325056.904, 3373779.755, 1965913.28, 1169997.442, 742885.0817, 533447.2943, 428709.4593, 380425.0587, 361015.9537, 371970.136, 329548.3402, 301358.9356, 261911.5786, 219209.416, 172767.9737, 131220.4955]
plt.plot(23,380425.0587,'*', color='red',markersize=10)
#plt.plot(savgol4x, savgol4y,'.')
#plt.plot(savgol4x, savgol4y,'-',label='4th order Savgol')

#SAVGOL 5 Polynomial
savgol5x = [51, 49, 47, 45, 43, 41, 39, 37, 35, 33, 31, 29, 27, 25, 23, 21, 19, 17, 15, 13, 11, 9, 7]
savgol5y = [43883672.87, 35310254.74, 26481970.86, 18439315.04, 12342627.01, 8162446.268, 5441703.299, 2421547.635, 2421547.635, 1584014.824, 1041239.967, 704479.5784, 520297.437, 425995.5722, 379827.1876, 360683.216, 372131.3223, 329614.3012, 301332.5269, 261900.7532, 219134.5783, 172732.7037, 131145.8993]
#plt.plot(savgol5x, savgol5y,'.')
#plt.plot(savgol5x, savgol5y,'-',label='5th order')

#SAVGOL 7 Polynomial
savgol7x = [51, 49, 47, 45, 43, 41, 39, 37, 35, 33, 31, 29, 27, 25, 23, 21, 19, 17, 15, 13, 11, 9]
savgol7y = [4747971.68, 3127024.863, 1954232.649, 1299459.79, 919665.0274, 696790.2609, 557703.4323, 456139.9402, 396659.9943, 361800.0371, 345492.8937, 347182.5617, 346845.293, 343760.8766, 340883.3548, 332685.1467, 272729.0049, 257338.1374, 223487.3716, 187720.4275, 153357.3959, 115759.8938]
#plt.plot(savgol7x, savgol7y,'.')
#plt.plot(savgol7x, savgol7y,'-',label='7th order')

#SAVGOL 9 Polynomial
savgol9x = [51, 49, 47, 45, 43, 41, 39, 37, 35, 33, 31, 29, 27, 25, 23, 21, 19, 17, 15, 13, 11]
savgol9y = [624096.9895, 474323.8748, 412945.4235, 379309.2505, 363074.1903, 354495.9195, 343085.9071, 340276.6491, 333903.1271, 338634.9705, 343974.5484, 336539.3897, 312681.7729, 312681.7729, 284682.2513, 231135.627, 233582.1431, 198019.9916, 166336.6281, 141336.247, 104810.1342]
#plt.plot(savgol9x, savgol9y,'.')
#plt.plot(savgol9x, savgol9y,'-',label='9th order')

#SAVGOL 11 Polynomial
savgol11x = [51, 49, 47, 45, 43, 41, 39, 37, 35, 33, 31, 29, 27, 25, 23, 21, 19, 17, 15, 13]
savgol11y = [368221.1088, 349024.3877, 341032.9398, 341052.9116, 340789.705, 336194.6452, 334997.2598, 330908.4032, 337545.4879, 333471.586, 314808.046, 298878.1574, 278254.604, 244885.8551, 207404.1728, 218480.9228, 177638.6034, 151837.6294, 132808.5366, 96587.23505]
#plt.plot(savgol11x, savgol11y,'.')
#plt.plot(savgol11x, savgol11y,'-',label='11th order')

#SAVGOL 13 Polynomial
savgol13x = [41, 39, 37, 35, 33, 31, 29, 27, 25, 23, 21, 19, 17, 15]
savgol13y = [5187824605, 5184461035, 5167276904, 5150734660, 557272.4665, 277093.8172, 254293.7879, 216518.7151, 196354.3138, 207829.027, 159617.2016, 142589.8571, 125646.9764, 90253.82762]
#plt.plot(savgol13x, savgol13y,'.')
#plt.plot(savgol13x, savgol13y,'-',label='13th order')

ffx = [5,6,7,8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 21, 23]
ffy = [270484481.1, 116049783.4, 31373833.22, 12958012.34, 4954630.247, 3257813.551, 2578316.731, 2214293.761, 2177257.85, 2155134.731, 2147796.663, 2131131.986, 2108999.815, 2096617.907, 2080665.412, 2038669.621, 2020054.642]
plt.plot(ffx, ffy,'.')
plt.plot(ffx, ffy,'-',label='Fourier Filter')

avx = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
avy = [0, 6799895, 26613507.44, 59056578, 103465544.6, 159005264.4, 224661577.4, 299266302, 381544203.6, 470179017.2, 563759019.7, 660956671.2, 760453259.1, 861003875.5, 961484840.7, 1060822405, 1158095020, 1252369233, 1343057094]
plt.plot(avx, avy,'.')
plt.plot(avx, avy,'-',label='Moving Average')
plt.legend()
plt.show()